{
  "$schema": "https://json-schema.org/draft-07/schema",
  "description": "Run all available checks (lint, test, build, typecheck) before committing - language agnostic",
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "scripts/pre-commit-checks.sh"
          }
        ]
      }
    ]
  },
  "_scripts": {
    "pre-commit-checks.sh": "#!/bin/bash\n\n# Check if this is a git commit command\nCOMMAND=$(echo \"$TOOL_INPUT\" | jq -r '.command // empty')\n\nif [[ \"$COMMAND\" != *\"git commit\"* ]]; then\n  exit 0\nfi\n\n# Skip if it's an amend with no changes or merge commit\nif [[ \"$COMMAND\" == *\"--amend\"* ]] || [[ \"$COMMAND\" == *\"--no-edit\"* ]]; then\n  exit 0\nfi\n\necho \"\"\necho \"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\"\necho \"ğŸ” Running pre-commit checks...\"\necho \"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\"\n\nFAILED=0\nCHECKS_RUN=0\n\n# Helper function to run a check\nrun_check() {\n  local name=\"$1\"\n  local cmd=\"$2\"\n  \n  echo \"\"\n  echo \"â–¶ Running: $name\"\n  if eval \"$cmd\" 2>&1; then\n    echo \"âœ“ $name passed\"\n  else\n    echo \"âœ— $name FAILED\"\n    FAILED=1\n  fi\n  CHECKS_RUN=$((CHECKS_RUN + 1))\n}\n\n# Detect project type and available tools\nDETECTED=\"\"\n\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n# JavaScript/TypeScript Detection\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nif [ -f \"package.json\" ]; then\n  DETECTED=\"$DETECTED nodejs\"\n  \n  # Check for available npm scripts\n  if command -v jq &> /dev/null; then\n    SCRIPTS=$(cat package.json | jq -r '.scripts // {} | keys[]' 2>/dev/null)\n    \n    # Lint check\n    if echo \"$SCRIPTS\" | grep -qE '^lint$'; then\n      run_check \"npm lint\" \"npm run lint\"\n    elif echo \"$SCRIPTS\" | grep -qE '^lint:check$'; then\n      run_check \"npm lint:check\" \"npm run lint:check\"\n    elif [ -f \"node_modules/.bin/eslint\" ]; then\n      run_check \"ESLint\" \"npx eslint . --max-warnings=0\"\n    elif [ -f \"node_modules/.bin/biome\" ]; then\n      run_check \"Biome\" \"npx biome check .\"\n    fi\n    \n    # Type check\n    if echo \"$SCRIPTS\" | grep -qE '^typecheck$'; then\n      run_check \"npm typecheck\" \"npm run typecheck\"\n    elif echo \"$SCRIPTS\" | grep -qE '^type-check$'; then\n      run_check \"npm type-check\" \"npm run type-check\"\n    elif echo \"$SCRIPTS\" | grep -qE '^types$'; then\n      run_check \"npm types\" \"npm run types\"\n    elif [ -f \"tsconfig.json\" ] && [ -f \"node_modules/.bin/tsc\" ]; then\n      run_check \"TypeScript\" \"npx tsc --noEmit\"\n    fi\n    \n    # Test check\n    if echo \"$SCRIPTS\" | grep -qE '^test$'; then\n      run_check \"npm test\" \"npm test -- --passWithNoTests 2>/dev/null || npm test\"\n    elif echo \"$SCRIPTS\" | grep -qE '^test:unit$'; then\n      run_check \"npm test:unit\" \"npm run test:unit\"\n    fi\n    \n    # Build check (verify it compiles)\n    if echo \"$SCRIPTS\" | grep -qE '^build$'; then\n      run_check \"npm build\" \"npm run build\"\n    fi\n  fi\nfi\n\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n# Python Detection\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nif [ -f \"pyproject.toml\" ] || [ -f \"setup.py\" ] || [ -f \"requirements.txt\" ] || ls *.py 1> /dev/null 2>&1; then\n  DETECTED=\"$DETECTED python\"\n  \n  # Ruff (fast linter)\n  if command -v ruff &> /dev/null; then\n    run_check \"Ruff lint\" \"ruff check .\"\n  # Flake8\n  elif command -v flake8 &> /dev/null; then\n    run_check \"Flake8\" \"flake8 .\"\n  # Pylint\n  elif command -v pylint &> /dev/null; then\n    run_check \"Pylint\" \"pylint **/*.py\"\n  fi\n  \n  # Type checking with mypy or pyright\n  if command -v mypy &> /dev/null; then\n    run_check \"mypy\" \"mypy .\"\n  elif command -v pyright &> /dev/null; then\n    run_check \"pyright\" \"pyright\"\n  fi\n  \n  # Pytest\n  if command -v pytest &> /dev/null; then\n    if [ -d \"tests\" ] || [ -d \"test\" ] || ls test_*.py 1> /dev/null 2>&1; then\n      run_check \"pytest\" \"pytest --tb=short -q\"\n    fi\n  fi\nfi\n\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n# Go Detection\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nif [ -f \"go.mod\" ]; then\n  DETECTED=\"$DETECTED go\"\n  \n  # Go vet (built-in linter)\n  if command -v go &> /dev/null; then\n    run_check \"go vet\" \"go vet ./...\"\n    \n    # golangci-lint (comprehensive linter)\n    if command -v golangci-lint &> /dev/null; then\n      run_check \"golangci-lint\" \"golangci-lint run\"\n    fi\n    \n    # Go build\n    run_check \"go build\" \"go build ./...\"\n    \n    # Go test\n    run_check \"go test\" \"go test ./... -short\"\n  fi\nfi\n\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n# Rust Detection\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nif [ -f \"Cargo.toml\" ]; then\n  DETECTED=\"$DETECTED rust\"\n  \n  if command -v cargo &> /dev/null; then\n    # Clippy (linter)\n    if cargo clippy --version &> /dev/null; then\n      run_check \"cargo clippy\" \"cargo clippy -- -D warnings\"\n    fi\n    \n    # Check (type check / compile check)\n    run_check \"cargo check\" \"cargo check\"\n    \n    # Tests\n    run_check \"cargo test\" \"cargo test --no-fail-fast\"\n  fi\nfi\n\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n# Ruby Detection\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nif [ -f \"Gemfile\" ]; then\n  DETECTED=\"$DETECTED ruby\"\n  \n  # RuboCop\n  if command -v rubocop &> /dev/null || [ -f \"Gemfile.lock\" ] && grep -q rubocop Gemfile.lock 2>/dev/null; then\n    run_check \"RuboCop\" \"bundle exec rubocop\"\n  fi\n  \n  # RSpec\n  if [ -d \"spec\" ]; then\n    run_check \"RSpec\" \"bundle exec rspec --fail-fast\"\n  fi\n  \n  # Minitest\n  if [ -d \"test\" ]; then\n    run_check \"Minitest\" \"bundle exec rake test\"\n  fi\nfi\n\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n# Java/Kotlin Detection (Maven/Gradle)\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nif [ -f \"pom.xml\" ]; then\n  DETECTED=\"$DETECTED java-maven\"\n  \n  if command -v mvn &> /dev/null; then\n    run_check \"Maven verify\" \"mvn verify -q\"\n  fi\nelif [ -f \"build.gradle\" ] || [ -f \"build.gradle.kts\" ]; then\n  DETECTED=\"$DETECTED java-gradle\"\n  \n  if [ -f \"gradlew\" ]; then\n    run_check \"Gradle check\" \"./gradlew check\"\n  elif command -v gradle &> /dev/null; then\n    run_check \"Gradle check\" \"gradle check\"\n  fi\nfi\n\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n# PHP Detection\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nif [ -f \"composer.json\" ]; then\n  DETECTED=\"$DETECTED php\"\n  \n  # PHP CS Fixer or PHP_CodeSniffer\n  if [ -f \"vendor/bin/php-cs-fixer\" ]; then\n    run_check \"PHP CS Fixer\" \"vendor/bin/php-cs-fixer fix --dry-run --diff\"\n  elif [ -f \"vendor/bin/phpcs\" ]; then\n    run_check \"PHP_CodeSniffer\" \"vendor/bin/phpcs\"\n  fi\n  \n  # PHPStan\n  if [ -f \"vendor/bin/phpstan\" ]; then\n    run_check \"PHPStan\" \"vendor/bin/phpstan analyse\"\n  fi\n  \n  # PHPUnit\n  if [ -f \"vendor/bin/phpunit\" ]; then\n    run_check \"PHPUnit\" \"vendor/bin/phpunit\"\n  fi\nfi\n\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n# .NET Detection\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nif ls *.csproj 1> /dev/null 2>&1 || ls *.sln 1> /dev/null 2>&1; then\n  DETECTED=\"$DETECTED dotnet\"\n  \n  if command -v dotnet &> /dev/null; then\n    run_check \"dotnet build\" \"dotnet build --no-restore\"\n    run_check \"dotnet test\" \"dotnet test --no-build\"\n  fi\nfi\n\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n# Elixir Detection\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nif [ -f \"mix.exs\" ]; then\n  DETECTED=\"$DETECTED elixir\"\n  \n  if command -v mix &> /dev/null; then\n    run_check \"mix compile\" \"mix compile --warnings-as-errors\"\n    run_check \"mix credo\" \"mix credo --strict\" 2>/dev/null || true\n    run_check \"mix test\" \"mix test\"\n  fi\nfi\n\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n# Swift Detection\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nif [ -f \"Package.swift\" ]; then\n  DETECTED=\"$DETECTED swift\"\n  \n  if command -v swift &> /dev/null; then\n    run_check \"swift build\" \"swift build\"\n    run_check \"swift test\" \"swift test\"\n  fi\nfi\n\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n# Summary\n# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\necho \"\"\necho \"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\"\n\nif [ $CHECKS_RUN -eq 0 ]; then\n  echo \"â„¹ï¸  No project-specific checks detected\"\n  echo \"   Detected environments:$DETECTED\"\n  echo \"   Tip: Add lint/test/build scripts to enable automatic checks\"\n  exit 0\nfi\n\nif [ $FAILED -eq 1 ]; then\n  echo \"âŒ PRE-COMMIT CHECKS FAILED\"\n  echo \"\"\n  echo \"Please fix the issues above before committing.\"\n  echo \"This helps prevent failing CI checks on your PR.\"\n  echo \"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\"\n  exit 1\nelse\n  echo \"âœ… All $CHECKS_RUN check(s) passed!\"\n  echo \"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\"\n  exit 0\nfi"
  },
  "_usage": {
    "install": "Copy scripts/pre-commit-checks.sh to your project or ~/.claude/scripts/",
    "configure": "Add this hook configuration to your ~/.claude/settings.json or .claude/settings.json",
    "supported_languages": [
      "JavaScript/TypeScript (npm, eslint, tsc, biome)",
      "Python (ruff, flake8, pylint, mypy, pyright, pytest)",
      "Go (go vet, golangci-lint, go test)",
      "Rust (cargo clippy, cargo check, cargo test)",
      "Ruby (rubocop, rspec, minitest)",
      "Java/Kotlin (maven, gradle)",
      "PHP (php-cs-fixer, phpcs, phpstan, phpunit)",
      ".NET (dotnet build, dotnet test)",
      "Elixir (mix compile, credo, mix test)",
      "Swift (swift build, swift test)"
    ],
    "note": "This hook auto-detects your project type and runs all available linters, type checkers, and tests before allowing a commit"
  }
}
